---
title: "Shifting Dynamics of Gender Representation in Canadian Municipal Elections"
subtitle: "An Analysis of Female Candidate Success Over Time, with a Focus on Trends, Incumbency, and Electoral Factors."
author: 
  - Hanqing Yang
thanks: "Code and data are available at: [https://github.com/RohanAlexander/starter_folder](https://github.com/RohanAlexander/starter_folder)."
date: today
date-format: long
abstract: "This paper examines how gender and other electoral factors influence the likelihood of candidates being elected in Canadian municipal elections, with a focus on how these dynamics have evolved over time. Using a logistic regression model that accounts for interactions between gender, election year, and incumbency, the study finds that while female candidates historically faced significant disadvantages, their probabilities of election have increased steadily in recent decades, particularly for non-incumbent candidates. Incumbency remains a strong predictor of electoral success, though male candidates benefit more from this advantage. These findings underscore the progress made toward gender equity in municipal elections while highlighting the persistent structural barriers that require continued attention to achieve full political representation."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(ggmosaic)
library(knitr)
library(kableExtra)
library(patchwork)
library(modelsummary)
library(arrow)

data <- read_csv("../data/02-analysis_data/analysis_data.csv") |> 
  mutate(gender = as.factor(gender),
         incumbent = as.factor(incumbent))
train_data <- read_parquet("../data/02-analysis_data/train_data.parquet")
test_data <- read_parquet("../data/02-analysis_data/test_data.parquet")


```


# Introduction

## Overview
Gender representation in politics is a key measure of societal progress and equality. Despite advancements, women remain underrepresented in municipal governance, even in developed democracies like Canada. Municipal elections are vital to shaping local governance and often act as entry points for future political leaders. However, the factors influencing female candidates' success at this level are not well understood.

This paper investigates how gender and other election factors influence electoral outcomes in Canadian municipal elections, with a focus on whether female candidates’ chances of being elected have improved over time. Leveraging data from the Canadian Municipal Elections Database (CMED), the analysis centers on the roles of gender, incumbency, and temporal trends, addressing gaps in understanding the evolving dynamics of gender representation at the municipal level.

## Estimand
The primary goal of this study is to estimate the effect of being a female candidate on the probability of election success in Canadian municipal elections, accounting for the roles of incumbency and election year. By including interaction terms for gender with election year and incumbency, the analysis investigates not only the main effects but also how these relationships have shifted over time. This approach allows for a detailed examination of gender dynamics in electoral success, capturing the interplay of structural and temporal factors.

## Results
The findings reveal that while female candidates have historically faced disadvantages in electoral success, these disparities have narrowed significantly over time. Interaction terms in the logistic regression model highlight that female candidates’ success rates have improved in more recent election years, especially for non-incumbent candidates. However, incumbency remains a significant predictor of election success, with male candidates benefiting more from this advantage compared to their female counterparts. The results indicate meaningful progress toward gender equity in municipal elections, although certain systemic advantages, such as incumbency, continue to reinforce inequalities.

## Why It Matters
Understanding the dynamics of gender representation in municipal elections is critical for advancing broader political equity. Municipal governance forms the backbone of political systems and directly impacts local policies and community outcomes. Equitable representation at this level not only ensures more inclusive decision-making but also creates pathways for women to ascend to higher political offices. By identifying the factors that influence female electoral success and how they evolve over time, this research provides valuable insights for policymakers, scholars, and activists working toward gender equality. Highlighting both progress and persistent barriers, the study contributes to ongoing discussions about fostering inclusivity and diversity in political institutions.

## Paper Structure
The remainder of this paper follows a structure @sec-data,@sec-model about the logistic regression model,@sec-result,@sec-discussion, @sec-appendix1 about survey methodology, @sec-data-details, @sec-model-details.

## Software, data and packages used
I use the statistical programming language R [@citeR], data from [@SP2/4MZJPQ_2020], and following packages: ggplot2 [@ggplot2], ggmosaic [@ggmosaic], modelsummary [@modelsummary], kableExtra [@kableExtra], knitr [@knitr], arrow [@arrow], and the data cleaning use package tidyverse [@tidyverse], dplyr [@dplyr], janitor[@janitor], rsample[@rsample].


# Data {#sec-data}
## Overview
We use the statistical programming language R [@citeR] to analyze the Canadian Municipal Elections Data. The dataset was obtained from the Borealis website [@SP2/4MZJPQ_2020] as of November 22, 2024. We chose the Archival format for its pre-cleaned, standardized structure, which simplifies analysis while retaining all relevant variables, consists of complete municipal election results for municipalities across Canada. Following statistical methods from "Telling Stories with Data" [@tellingstories], we predict the effect of gender on election outcomes and examine its interaction with election year to analyze trends in female representation over time.

This dataset includes 110,800 observations and 19 variables, covering candidate detail such as incumbency status, gender, and election context across different provinces and years.To ensure reliable and efficient analysis, we removed observations with missing values and duplicate rows, retaining 84,028 records from various regions across Canada, ensuring high generalizability.

While similar datasets exist at the provincial level (e.g., CivicInfoBC or Élections Québec), CMED stands out for its national scope, since provincial election results lack nationwide coverage and some of them missing gender data, making them unsuitable for studying gender representation across Canada.

## Data cleaning and Constructed variable
The original raw dataset has 110800 observation, but the cleaned dataset we use after omit observation with missing value has 84028 observation.Still big enough for give representative statistical result.
A constructed variable, `predicted_prob`, was added to the test dataset to represent the predicted probability of election success for each candidate. This variable was generated using the logistic regression model described in the model section, allowing for direct comparison between predicted probabilities and actual election outcomes. Additionally, it facilitates analyses of how predicted success rates vary across key factors such as gender, incumbency, and election year, aligning with the study’s aim to explore the dynamics influencing electoral success.

## Measurement
The Canadian Municipal Elections Database (CMED) captures real-world electoral phenomena through a combination of official records, archival materials, and manual coding. For instance, the `gender` variable was often missing in original datasets, particularly for historical records. In these cases, gender was coded manually using candidate photographs, self-descriptions, and pronoun usage from online sources, ensuring accurate representation. Similarly, `incumbent` status, which identifies whether a candidate held the same office prior to the election, was verified through official election results and cross-referenced with newspaper archives, such as the *Calgary Herald* and *Edmonton Journal*, providing a reliable measure of incumbency.

The `elected` variable reflects whether a candidate won (`1`) or lost (`0`), directly measuring electoral success. For example, in Quebec and British Columbia, provincial databases provided detailed election results, while in cities like Toronto and Montreal, election data were manually digitized from archived municipal records. These processes converted fragmented and varied election results into a standardized dataset, ensuring a consistent and accurate representation of municipal elections across Canada.

## Outcome variables
```{r,fig.height= 5, fig.width = 8}
#| label: fig-summary
#| fig-cap: Summary table showing the distribution of candidates' elected status, including the total number and percentage of those elected ('Elected') and not elected, along with an overall total row to provide a comprehensive overview of the dataset's balance.
#| echo: false

# Summary table
outcome_summary <- data %>%
  group_by(elected) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(data)) * 100, 2)
  ) %>%
  mutate(Elected_Status = ifelse(elected == 1, "Elected", "Not Elected")) %>%
  select(Elected_Status, Count, Percentage) %>%
  bind_rows(
    tibble(Elected_Status = "Total",
           Count = nrow(data),
           Percentage = 100)
  )

knitr::kable(outcome_summary)

```

```{r}
#| label: fig-mosaic
#| fig-cap:  Mosaic plot showing the distribution of elected status ('Elected' and 'Not Elected') by gender ('Male' and 'Female'), highlighting the relative proportions of male and female candidates in each elected category, with percentages of male/female candidate being elected/not elected annotated.
#| echo: false
#| warning: false
#| message: false

# Load necessary libraries
# library(ggmosaic)
# library(ggplot2)
# library(dplyr)

# Calculate percentages to label on the mosaic plot

# 1. Percentage of male and female in the election race
gender_race_percentage <- data %>%
  group_by(gender) %>%
  summarise(Count = n(), .groups = "drop") %>%
  mutate(
    Total = sum(Count),
    Percentage = round((Count / Total) * 100, 1),
    Gender = ifelse(gender == 0, "Male", "Female")
  )

# 2. Percentage of male and female being elected
elected_percentage <- data %>%
  filter(elected == 1) %>%
  group_by(gender) %>%
  summarise(Count = n(), .groups = "drop") %>%
  mutate(
    Total = sum(Count),
    Percentage = round((Count / Total) * 100, 1),
    Gender = ifelse(gender == 0, "Male", "Female"),
    elected_status = "Elected"
  )

# 3. Percentage of male and female being not elected
not_elected_percentage <- data %>%
  filter(elected == 0) %>%
  group_by(gender) %>%
  summarise(Count = n(), .groups = "drop") %>%
  mutate(
    Total = sum(Count),
    Percentage = round((Count / Total) * 100, 1),
    Gender = ifelse(gender == 0, "Male", "Female"),
    elected_status = "Not Elected"
  )

# Combine percentages for annotation
percentages <- bind_rows(elected_percentage, not_elected_percentage)

# Adjust positions for annotations
percentages <- percentages %>%
  mutate(
    x = ifelse(elected_status == "Not Elected", 0.25, 0.75), # Assign x position for "Not Elected" and "Elected"
    y = ifelse(Gender == "Male", 0.25, 0.9), # Assign y position for "Male" and "Female" within each category
    Label = paste0(Percentage, "%") # Create label with percentage
  )

# Create the mosaic plot with percentage labels
ggplot(data = data) +
  geom_mosaic(aes(x = product(elected), fill = gender)) +
  geom_text(
    data = percentages,
    aes(
      x = x,
      y = y,
      label = Label
    ),
    color = "white",
    size = 6
  ) +
  labs(
    title = "Mosaic Plot of Elected Status by Gender",
    x = "Elected Status",
    fill = "Gender"
  ) +
  scale_x_productlist(labels = c("0" = "Not Elected", "1" = "Elected")) +
  scale_fill_manual(values = c("blue", "pink"), labels = c("Male", "Female")) +
  theme_minimal()


```
The **outcome variable** in this study is `elected`, which indicates whether a candidate was successfully elected (`1`) or not (`0`) in a given municipal race. According to the codebook, this variable is available for all observations in the Canadian Municipal Elections Database (CMED) and captures the fundamental result of each race. Figure (@fig-summary) show 51.68% of candidates were elected, while 48.32% were not, providing a relatively balanced outcome for analysis.

The variable is critical for this study as it allows the examination of factors influencing electoral success, such as gender, incumbency, and election year, and enables an investigation into how gender dynamics have evolved over time. By analyzing the patterns in `elected`, the study aims to understand broader trends in gender representation and equality across Canada’s municipal elections. 

The mosaic plot (@fig-mosaic) visualizes the outcome variable `elected`, depicting the proportion of candidates by gender across "Elected" and "Not Elected" categories. It highlights the gender distribution in electoral outcomes, revealing that among those elected, 73.8% are male and 26.2% are female, underscoring a notable gender imbalance in local government representation in Canada.

## Predictor variables
### Gender
```{r,fig.height= 6, fig.width = 8}
#| label: fig-gender
#| fig-cap:  Plot illustrating the gender distribution of candidates, with the number of male and female candidates represented by bar heights and their respective percentages labeled above each bar to highlight proportional representation.
#| echo: false
#| warning: false
#| message: false

# Load necessary libraries
# library(ggplot2)
# library(dplyr)

# Summarize the gender variable
gender_summary <- data %>%
  group_by(gender) %>%
  summarise(Frequency = n()) %>%
  mutate(
    Percentage = round((Frequency / sum(Frequency)) * 100, 1),
    Label = paste0(Percentage, "%")
  )

# Create the bar plot
ggplot(gender_summary, aes(x = gender, y = Frequency, fill = gender)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  geom_text(aes(label = Label), vjust = -0.5, size = 5) +
  labs(
    title = "Gender Distribution",
    x = "Gender",
    y = "Count"
  ) +
  scale_fill_manual(values = c("blue", "pink"), labels = c("Male", "Female")) +
  theme_minimal()

```
The `gender` variable captures the candidate's gender and is included in the full Canadian Municipal Elections Database (CMED). It is coded as a binary factor (`Female = 1`, `Male = 0`) to facilitate analysis of the baseline gender effect on election outcomes. Despite minor missing data in some datasets, primarily due to incomplete candidate name information, this variable serves as a key predictor for examining the influence of gender on electoral success.

The plot (@fig-gender) illustrates the distribution of gender among candidates in Canadian municipal election races, show a notable gender imbalance over time. Specifically, 75.8% of candidates are male, while only 24.2% are female, highlighting the underrepresentation of women in local government elections.


### Incumbent
```{r}
#| label: fig-incumbent
#| fig-cap: Mosaic plot visualizing the relationship between elected status ("Elected" and "Not Elected") and incumbency status ("Not Incumbent" in yellow and "Incumbent" in green), highlighting the distribution of incumbents and non-incumbents across election outcomes.
#| echo: false
#| warning: false
#| message: false

# mosaic plot for visualizing incumbent variable
ggplot(data = data) +
  geom_mosaic(aes(x = product(elected), fill = incumbent)) +
  labs(title = "Mosaic Plot of Elected Status by incumbent",
       x = "Elected Status",
       fill = "incumbent") +
  scale_x_productlist(labels = c("0" = "Not Elected", "1" = "Elected")) +
  scale_fill_manual(values = c("yellow", "green"),
                    labels = c("not incumbent", "incumbent")) +
  theme_minimal()

```
The **incumbent** variable (`Incumbent = 1`, `Not Incumbent = 0`) identifies whether a candidate held the same office prior to the election and is available for the full CMED dataset. Incumbency is a key predictor of electoral success, often linked to advantages like name recognition, experience, and access to resources. 
The mosaic plot (@fig-incumbent) illustrates the relationship between incumbency and electoral outcomes, showing that incumbents are more likely to be elected than challengers.


### Election Year
```{r}
#| label: fig-year
#| fig-cap: "Line plot showing the number of male and female candidates in Canadian municipal elections over time, highlighting a sharp increase in candidate participation post-2000 and a persistent gender gap, with male candidates consistently outnumbering female candidates."
#| echo: false
#| warning: false
#| message: false

# Count candidates by election year and gender
yearly_counts <- data %>%
  group_by(election_year, gender) %>%
  summarise(Count = n(), .groups = "drop")

# Line plot for visulizing election_year
ggplot(yearly_counts, aes(x = election_year, y = Count, color = gender, group = gender)) +
  geom_line(size = 1) +
  scale_color_manual(values = c("skyblue", "pink"), labels = c("Male", "Female")) +
  labs(
    title = "Number of Candidates Over Time by Gender",
    x = "Election Year",
    y = "Number of Candidates",
    color = "Gender"
  ) +
  theme_minimal()
```
The **election_year** variable records the year of each election.It is critical for analyzing temporal trends, enabling an understanding of how electoral outcomes, candidate participation, and gender representation have evolved over time. 
(@fig-year) depicts the number of male and female candidates across election years, showing a sharp increase in participation post-2000, while also highlighting a persistent gender gap, with male candidates consistently outnumbering female candidates.

```{r}
#| label: tbl-summaryx
#| fig-cap: Summary table displaying key descriptive statistics for predictor variables, including the counts and proportions of female and male candidates, incumbent and non-incumbent candidates, and the range of election years covered in the dataset.
#| echo: false
#| warning: false
#| message: false
# Generate summary for each predictor
summary_table <- data %>%
  summarise(
    # Gender
    Gender_Female = sum(gender == 1, na.rm = TRUE),
    Gender_Male = sum(gender == 0, na.rm = TRUE),
    Gender_Proportion_Female = round(mean(gender == 1, na.rm = TRUE) * 100, 2),
    
    # Incumbent
    Incumbent = sum(incumbent == 1, na.rm = TRUE),
    Non_Incumbent = sum(incumbent == 0, na.rm = TRUE),
    Incumbent_Proportion = round(mean(incumbent == 1, na.rm = TRUE) * 100, 2),
    
    # Election Year
    Min_Election_Year = min(election_year, na.rm = TRUE),
    Max_Election_Year = max(election_year, na.rm = TRUE)
    ) %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")

# Print the summary table
summary_table

```
Finally, the table @tbl-summaryx give a summary table for this 3 predictor variables: gender, incumbent and election_year.

### Interaction term
**Gender * Election Year**
```{r}
#| label: fig-gender_year
#| fig-cap: Line plot showing the proportion of candidates elected over time by gender, with separate lines for male (blue) and female (pink) candidates, highlighting trends in gender representation across election years.
#| echo: false
#| warning: false
#| message: false
# Calculate proportions of elected by gender and year
gender_year_data <- data %>%
  group_by(election_year, gender) %>%
  summarise(Proportion_Elected = mean(elected == 1, na.rm = TRUE), .groups = "drop")

# Line plot
ggplot(gender_year_data, aes(x = election_year, y = Proportion_Elected, color = gender, group = gender)) +
  geom_line(size = 1.2) +
  scale_color_manual(values = c("pink", "blue"), labels = c("Female", "Male")) +
  labs(
    title = "Proportion of Candidates Elected Over Time by Gender",
    x = "Election Year",
    y = "Proportion Elected",
    color = "Gender"
  ) +
  theme_minimal()

```
The interaction between gender and election_year provides insights into how the relationship between gender and electoral success evolves over time. Examining this interaction helps assess whether gender disparities in municipal election outcomes have changed or remained consistent across different years.

The plot (@fig-gender_year) illustrates the proportion of male and female candidates elected over time. Male candidates consistently show higher success rates, with significant year-to-year fluctuations, while female candidates exhibit a more stable trend but consistently lower proportions. Although the gender gap appears to narrow slightly in recent years, the persistent disparity highlights the importance of analyzing how gender and election year jointly influence electoral outcomes.


**Gender * Incumbent**
```{r}
#| label: fig-gender_incumbent
#| fig-cap: Faceted bar chart showing the proportion of elected outcomes ("Elected" and "Not Elected") by gender ("Male" and "Female") for incumbents and non-incumbents, illustrating how incumbency influences election success differently for male and female candidates.
#| echo: false
#| warning: false
#| message: false

# Faceted bar chart
ggplot(data, aes(x = gender, fill = as.factor(elected))) +
  geom_bar(position = "fill", color = "grey") +
  facet_wrap(~incumbent, labeller = labeller(incumbent = c("0" = "Not Incumbent", "1" = "Incumbent"))) +
  scale_fill_manual(values = c("purple", "lightblue"), labels = c("Not Elected", "Elected")) +
  scale_x_discrete(labels = c("0" = "Male", "1" = "Female")) +
  labs(
    title = "Elected Outcomes by Gender and Incumbency",
    x = "Gender",
    y = "Proportion",
    fill = "Elected Status"
  ) +
  theme_minimal()

```
The interaction term `gender * incumbent` examines how incumbency status influences election outcomes for male and female candidates. This term allow us to understand whether the incumbency advantage differs by gender, highlighting disparities in electoral success.
(@fig-gender_incumbent) shows the proportion of elected outcomes by gender, split by incumbency status. Among non-incumbents, both male and female candidates show low success rates, with male candidates being slightly less likely to be elected. while among incumbents, the election success rates for both genders are substantially higher, indicating incumbency strongly enhances electoral success for both genders but suggests potential differences in how gender interacts with incumbency.


# Model {#sec-model}
The goal of our modelling strategy is to use logistic regression model to investigate the relationship between Canadian Municipal Election outcome and the gender, incumbency status of candidate, and year of elections, and compare the difference in predicted probability of election success rate across gender.
Model detail, validation and diagnostics are included in [Appendix -@sec-model-details].

We fit a model with three main predictors **gender**, **incumbent** and **election_year**, and two interaction terms including **gender *election_year** and **gender * incumbent**. 

The model use following predictors:

   - **gender**: categorical variable record candidates' gender, 1 for female, 0 for male. Use to analyze the influence of gender on electoral success.

   - **incumbent**: categorical variable to account for the incumbency advantage.

   - **election_year**: numerical variable record year of election, to investigate changes over time.

   - **Interactions**:

     - **gender * election_year**: To assess whether the gender effect has changed over time.

     - **gender * incumbent**: To examine whether incumbency impacts male and female candidates differently.

## Alternative model
While a Bayesian approach was initially considered for this analysis, it was ultimately not chosen for several reasons. First, the lack of well-informed priors limited the utility of Bayesian modeling, as priors would need to be based on strong external evidence to improve model performance. Second, the dataset's large size (62959 observations) supports the stability of maximum likelihood estimates, making frequentist logistic regression a computationally efficient and reliable choice. The frequentist approach avoids the added complexity and computational demands of Bayesian modeling, which can be especially significant for large datasets with many predictors and interactions.
Additionally, a simpler **base model** with only three predictors—gender, incumbent, and election_year—was considered to allow exploration of the main effects. However, this approach assumes that the effects of these predictors are independent and static over time. The full model, in contrast, includes interaction terms (gender × election_year and gender × incumbent) that are essential to address the study's aim of examining the evolving impact of gender on election success. These interaction terms capture how the gender gap changes over time and varies with incumbency. As the base model lacks the ability to capture these relationships, it was deemed insufficient for both interpretation and prediction. Thus, the full logistic regression model was chosen for its ability to align with the research objectives and provide a more detailed analysis.

## Model Set-up
A logistic regression model was chosen to analyze the numerical response variable (`elected`) with binary outcome, which follows a Bernoulli distribution and indicates whether the candidate was successfully elected (`elected = 1`) or not (`elected = 0`) in a municipal election. This framework models the probability of being elected using the logit function, which transforms the linear combination of predictors into probabilities.

**Model**
\begin{align*}
    elected_i &\sim \text{Bernoulli}(\text{Pr}(elected_i = 1)) \\
    \text{logit}(\text{Pr}(elected_i = 1)) &= \beta_0 + \beta_1 \cdot \text{gender}_i + \beta_2 \cdot \text{incumbent}_i + \beta_3 \cdot \text{election\_year}_i \\
    &\quad + \beta_4 \cdot (\text{gender}_i \times \text{election\_year}_i) + \beta_5 \cdot (\text{gender}_i \times \text{incumbent}_i) 
\end{align*}

\textbf{Where:}
\begin{itemize}
    \item $\beta_0$ is the intercept term, represents the baseline log-odds of being elected when all predictors are at their reference level.
    \item $\beta_1, \beta_2, \beta_3, \beta_4, \beta_5$ are the coefficients for each predictor, correspond to the effects of the predictors on the log-odds of being elected
\end{itemize}

This modeling approach allows for an exploration of both the main effects and the potential interactions between gender, incumbency, and time. It allow investigation of effect of gender, incumbent and election_year on election outcome, and also explain how gender dynamics in elections have evolved over time and how incumbency advantages differ between male and female candidates. 

We run the model in R [@citeR] by using the function glm() to build a prediction-focused logistic regression model on training data.
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
# Load the model
model <-
  readRDS(file = here::here("models/model.rds"))
```


### Model justification
Existing research and political science theories suggest that factors such as candidate gender, incumbency status, and the year of the election can influence electoral outcomes in Canadian municipal elections. Historically, male candidates have historically been more likely to succeed than female candidates, particularly in earlier years, highlighting persistent gender disparities in political representation. Incumbents benefit from name recognition, political experience, and access to resources, giving them a substantial advantage in elections. Over time, societal shifts toward inclusivity and equity are hypothesized to reduce these disparities, which motivates the inclusion of interaction terms, such as between gender and election year. Similarly, the interaction between gender and incumbency allows for assessing whether the advantage of incumbency is distributed equitably across genders. These predictors were selected based on their relevance to the research question and their clear definition in the data section.

A logistic regression model was used because the response variable—whether a candidate is elected—is binary, making it well-suited to a Bernoulli distribution. Logistic regression is ideal for modeling binary outcomes as a function of multiple predictors, providing interpretable log-odds of being elected. The inclusion of interaction terms enables an exploration of changing gender dynamics over time and across incumbency statuses, aligning with the study's objective to examine how gender and other election factors jointly influence electoral success.

Including interaction terms in the model adds complexity but is justified by theoretical motivations and supported by the dataset's large size. This approach provides a richer, context-specific understanding of the interplay between gender, incumbency, and election year, offering a deeper analysis of the factors driving electoral outcomes.

## Model validation and checking
### Train Test Validation
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
# Predict probabilities on the test set
test_data$predicted_prob <- predict(model, newdata = test_data, type = "response")

# Convert probabilities to binary predictions (threshold = 0.5)
test_data$predicted_class <- ifelse(test_data$predicted_prob > 0.5, 1, 0)

```

```{r}
#| label: fig-matrix
#| fig-cap: Confusion matrix justify the prediction of the model
#| echo: false
#| warning: false
#| message: false

confusion <- table(test_data$elected, test_data$predicted_class, dnn = c("Actual", "Predicted"))
knitr::kable(confusion)
```

```{r}
#| echo: false
#| eval: false
#| warning: false
#| message: false
accuracy <- sum(diag(confusion)) / sum(confusion)
accuracy
```


```{r}
#| echo: false
#| eval: false
#| warning: false
#| message: false
null_deviance <- model$null.deviance
residual_deviance <- model$deviance
mcfadden_r2 <- 1 - (residual_deviance / null_deviance)
mcfadden_r2

```

A train-test split validation approach was employed to evaluate the performance of the logistic regression model in predicting the probabilities of being elected in Canadian municipal elections. The dataset was randomly divided into a training set (70%) for model fitting and a test set (30%) for evaluation.

The model was fitted using the `glm()` function on the training data, and predictions were generated for the test set. A confusion matrix (@fig-matrix) highlights the model's strengths and weaknesses: it performs well in predicting "Not Elected" but has greater difficulty predicting "Elected," likely reflecting data imbalance or complexities in modeling election dynamics.

Two key performance metrics were calculated:

- **Accuracy:** 70.16%, indicating that the model correctly classifies about 70% of the test set observations. However, accuracy alone may not fully capture model performance, especially if the dataset is imbalanced (e.g., more "Not Elected" cases than "Elected").

- **McFadden's R^2:** 0.15, suggesting a modest model fit. While lower than R square values typically observed in linear regression, this is acceptable in logistic regression, where values between 0.2 and 0.4 are considered strong.

Overall, the validation metrics indicate that the model is reasonably effective, though there may be limitations in capturing the nuances of factors influencing election success.


# Results {#sec-result}
```{r}
#| label: tbl-modelresult
#| fig-cap: "Summary table of coefficients and fit statistics for the logistic regression models predicting election probability."
#| echo: false
#| warning: false
#| message: false

# Generate the table
modelsummary(
  list(model),
  fmt = 1
)
```

Our results are summarized in @tbl-modelresult  by use package [@modelsummary].
The results from the logistic regression model show how the factors influencing electoral success and how these relationships vary across gender, incumbency, and over time. The coefficient for `gender1` is strongly negative (-33.466, standard error: 3.143), indicating that female candidates generally have a lower probability -33.5% of being elected compared to male candidates. However, the interaction term between `gender` and `election_year` (0.017, standard error: 0.002) is positive and statistically significant, which suggests that the disparity in election success rates between genders has decreased over time, favoring female candidates more in recent years.

The coefficient for `incumbent1` is positive (2.146, standard error: 0.024), underscoring the significant advantage incumbents have in election outcomes. The interaction between `gender` and `incumbent` is negative (-0.260, standard error: 0.042), suggesting that the incumbency advantage is not uniform between genders and is less pronounced for female candidates. The coefficient for `election_year` is close to zero (0.000, standard error: 0.000), indicating minimal direct change in the probability of election success attributable solely to the passage of time.

Overall, the model highlights the evolving dynamics of gender and election success, emphasizing the importance of considering interaction effects to capture the complexity of these relationships. While the main effect of `gender` suggests a disadvantage for female candidates, the positive interaction with `election_year` shows that this gap has been gradually narrowing. The strong and consistent incumbency effect across the model and its differential impact by gender also illustrate the nuances in electoral success influenced by candidate characteristics and election history.

### Predicted Probabilities of Being Elected Over Time for Male and Female Candidates
```{r}
#| label: fig-result2
#| fig-cap: Predicted probabilities of being elected over time for male and female candidates, separated by incumbent status, highlighting differences in gender dynamics and trends across election years.
#| echo: false
#| warning: false
#| message: false

# Load required libraries
# library(ggplot2)

# facet line plot
ggplot(test_data, aes(x = election_year, y = predicted_prob, color = as.factor(gender))) +
  geom_line(size = 1.2) +
  facet_wrap(~incumbent, labeller = labeller(incumbent = c("0" = "Not Incumbent", "1" = "Incumbent"))) +
  scale_color_manual(values = c("blue", "pink"), labels = c("Male", "Female")) +
  labs(
    x = "Election Year",
    y = "Predicted Probability",
    color = "Gender"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom"
  )


```
The model which includes interaction terms for both gender and election year, as well as gender and incumbency status, provides a detailed analysis of the evolving gender dynamics in electoral outcomes. In (@fig-result2), for non-incumbents, the predicted probability of election for female candidates has steadily increased over time, eventually surpassing that of male candidates in recent years. This trend suggests significant progress toward gender parity for non-incumbent candidates. On the other hand, among incumbents, the probability of election for female candidates has consistently increased at a steeper rate than for male candidates, narrowing the gap but not completely eliminating it. The interaction effects highlight how gender and incumbency jointly shape electoral success, illustrating broader societal shifts toward inclusivity. The results suggest that while progress is being made, female candidates—particularly incumbents—still face challenges in achieving parity with their male counterparts.



## Gender Gap in Predicted Election Probability Over Time
```{r}
#| label: fig-result3
#| fig-cap: Gender gap in predicted probability of being elected (Male - Female) over time, illustrating changes in gender disparities in electoral success across election years. Gaps in the plot reflect missing data for specific gender-election year combinations.
#| echo: false
#| warning: false
#| message: false

# Aggregate predictions by gender and election year
gender_gap_data <- test_data %>%
  group_by(gender, election_year) %>%
  summarise(predicted_prob = mean(predicted_prob), .groups = "drop") %>%
  spread(key = gender, value = predicted_prob) %>%
  mutate(gap = `0` - `1`)  # Male (0) - Female (1)


# Plot gender gap
ggplot(gender_gap_data, aes(x = election_year, y = gap)) +
  geom_line(color = "darkred", size = 2) +
  labs(
    x = "Election Year",
    y = "Gender Gap (Male - Female)"
  ) +
  theme_minimal()

```
The plot (@fig-result3) illustrates the evolution of the gender gap in predicted probabilities of being elected (Male - Female) over time, capturing how disparities in electoral success have shifted. The gender gap shows a decreasing trend, particularly in recent decades, reflecting a narrowing of the difference in predicted probabilities between male and female candidates. This trend suggests that female candidates have experienced increasing success in municipal elections, consistent with societal shifts toward gender equity.

The gaps or missing segments in the line plot likely correspond to years in which data for either male or female candidates were insufficient or absent. Such gaps emphasize potential limitations in the dataset, possibly due to a lack of female participation in earlier elections. The overall trend highlights progress in closing the gender gap in electoral outcomes, particularly for non-incumbent candidates, but also underscores the historical underrepresentation of women in electoral contexts. This result aligns with the study's goal of examining evolving gender dynamics in electoral success.


# Discussion {#sec-discussion}

## 1. What is done in this paper?
This paper investigates the relationship between electoral success in Canadian municipal elections and factors such as gender, incumbency status, and election year, with a primary focus on understanding how the impact of gender has changed over time. A logistic regression model with interaction terms was used to analyze how these predictors and their combinations influence the likelihood of being elected. The model accounts for the evolving role of gender dynamics over time and the potential variation in incumbency advantages across genders, and predict the probability of be elected for both male and female to compare the gender gap change. Train-test validation was employed to evaluate the model's performance, providing measures such as accuracy and McFadden’s R square, which confirmed the model's adequacy for studying these relationships and making predictions.

## 2. What is something that we learn about the world?
The findings underscore significant progress in gender equity in municipal elections over the past century. Historically, male candidates enjoyed a clear advantage in electoral success, particularly among incumbents. However, the interaction between gender and election year reveals a meaningful narrowing of this gender gap, with female candidates’ success rates improving notably in recent decades. For non-incumbents, female candidates’ predicted probabilities of election now approach or exceed those of male candidates, suggesting that societal and institutional shifts are contributing to more equitable outcomes. Incumbency, however, remains a powerful predictor of success, benefiting candidates of both genders but with a somewhat larger advantage observed for male incumbents. These results highlight how broader social changes have influenced gender disparities in electoral outcomes while pointing to areas where inequities persist.


## 3. What is another thing that we learn about the world?
The analysis demonstrates that the interaction effects between gender, incumbency, and election year capture nuanced patterns that single predictors cannot reveal. For instance, while incumbency generally boosts electoral success, male incumbents appear to benefit more from this advantage than their female counterparts. The gender gap in predicted probabilities of election success is most pronounced among non-incumbents, emphasizing the continued challenges for female candidates without established political presence. These findings highlight the importance of considering intersectional factors to understand electoral disparities comprehensively.

## 4. What are some weaknesses of what was done?
One limitation of this study lies in the potential multicollinearity between gender and its interactions, particularly between the `gender` variable and its interaction term with `election_year` in the model, which may complicate coefficient interpretation. While centering election year could mitigate this issue, it was not implemented to preserve the interpretability of the results. Additionally, the analysis assumes that all included variables are measured without bias or error, which may not fully capture the complexities of electoral dynamics. The dataset, although extensive, does not include other potentially influential variables, such as campaign funding or voter demographics, which could further elucidate the observed patterns.

## 5. What is left to learn or how should we proceed in the future?
Future research could explore additional predictors, such as socioeconomic factors, voter turnout, or candidate campaign characteristics, to refine the understanding of electoral success. Incorporating qualitative data, such as interviews with candidates, might provide deeper insights into the barriers female candidates face. Methodologically, Bayesian modeling with well-informed priors could be revisited to incorporate expert knowledge and assess uncertainty more robustly. Lastly, extending this analysis to other countries or levels of government could offer a comparative perspective on the factors shaping electoral outcomes across different political contexts.



\newpage

\appendix

# Appendix1 {#sec-appendix1}

# Additional data details {#sec-data-details}

# Model details {#sec-model-details}






\newpage


# References


